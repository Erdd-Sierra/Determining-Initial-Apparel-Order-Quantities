# SCM 発注シミュレータ：ログ



- **全体コンセプト**: 不確実な需要を三角分布で生成し、需要ごとにMIPを解いて最適発注量を決定。合計発注量1万を等式制約で固定し、最小ロット（香港600/中国1200）はBig-Mで表現。Streamlitタブ（香港/中国/統計/可視化/全結果）で操作。



## バージョン別の進展と課題

- **v1〜v2（初期仕様）**

  - やったこと: `requirements.md` を基に損失最小化MIPを構築。10商品の需要・価格・損失係数をコード内定数化。三角分布で需要生成、CSV不要化。

  - 足りないこと: 利益最大化へ未転換。ロット未満の補正なし。可視化・統計が簡易。



- **v3（MIPロジック強化）**

  - やったこと: 不足/余剰整合式 `x_j - D_j = s_j - e_j` を明示。総発注量=10000の等式制約を導入。最小ロットをBig-M（0またはロット以上）で実装。

  - 足りないこと: UI未整備。ロット補正後の合計調整なし。目的関数はまだ損失最小。



- **v4（UI/UX整備）**

  - やったこと: Streamlitタブで香港/中国を独立計算。サイドバーに試行回数設定（デフォルト100、最大1000）。`streamlit run 5th_program.py` で一体起動。

  - 足りないこと: 利益最大化への改訂前。ロット補正＋合計再配分なし。統計・可視化は軽量。



- **v5（仕様拡張・透明性強化）**

  - やったこと: `requirements5.md` に従い目的を利益最大化へ変更し、Underage/Overageを損失控除扱いに。推奨量がロット未満なら自動補正し、合計1万へ比例再配分。推奨指標を平均・中央値・四捨五入後最頻値から選択可。全結果テーブル、統計（平均/中央値/最小/最大/標準偏差、遵守率・0発注率）、可視化（箱ひげ・利益ヒストグラム・比較棒）を実装し、CSVダウンロード対応。

  - 足りないこと: ソルバー設定チューニング、実行時間短縮、パラメータ感度分析、テストコード整備。



## 現在地

- 実行ファイル: `5th_program.py`

- 仕様ドキュメント: `requirements.md`（損失最小版）、`requirements5.md`（利益最大化版）

- README: Version 5.0 として機能追加（推奨方法選択、ロット調整、統計・可視化、CSV出力）を明記済み。

